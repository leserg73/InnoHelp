<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="Content-Language" content="ru" />
    <meta http-equiv="X-UA-Compatible" content="IE=8" />
    <meta content="Перевод на русский: Сергей Леонов (aka Leserg)" name="description" />
    <title>[Setup]: TerminalServicesAware</title>
    <!--[if IE 6]><style type="text/css">html{overflow-y:scroll}</style><![endif]-->
    <link rel="stylesheet" type="text/css" href="../css/styles.css" />
    <script type="text/javascript" src="../js/topic.js"></script>
    <script type="text/javascript" src="../js/jquery.js"></script>
    <script type="text/javascript" src="../js/highlight.js"></script>
    <script type="text/javascript">
      $(document).ready(function(){highlight();});
    </script>
  </head>
  <body>
    <h1 class="topicheading">[Setup]: TerminalServicesAware</h1>
    <div class="topicbody">
      <table class="setuphdr">
        <tbody>
          <tr class="setuphdrtr1">
            <td class="setuphdrl">
              <p>Допустимые значения:</p>
            </td>
            <td class="setuphdrr">
              <div class="margined"><a href="topic_yesnonotes.htm"><tt class="nill">yes</tt>
                  или <tt class="nill">no</tt></a> </div>
            </td>
          </tr>
          <tr class="setuphdrtr2">
            <td class="setuphdrl">
              <p>Значение по умолчанию:</p>
            </td>
            <td class="setuphdrr">
              <div class="margined"><tt class="nill">yes</tt> </div>
            </td>
          </tr>
        </tbody>
      </table>
      <h2 class="heading">Описание</h2>
      <p>Указывает компилятору о необходимости установки флага
        "Terminal Services aware" (Поддержка сервер терминалов) в заголовок
        образа программы установки и удаления. Эта функция появилась в версии
        5.1.7 и по умолчанию имеет значение <tt>yes</tt>; предыдущие версии
        этот флаг никогда не устанавливали.</p>
      <p>Самое главное, что флаг "Terminal Services aware"
        влияет на поведение константы {win} (и функции <a href="topic_isxfunc_getwindir.htm">GetWinDir</a>)
        на серверах с установленными службами терминалов в режиме приложения.</p>
      <p>Если флаг установлен, константа {win} будет
        последовательно возвращать реальный системный каталог Windows, обычно
        "C:\WINDOWS", даже на системах, в которых не установлены службы
        терминалов.</p>
      <p>Если флаг не установлен, Windows будет запускать
        программу в режиме совместимости, где константа {win} может вернуть либо
        настоящий каталог Windows, либо пользовательский каталог Windows,
        который находится по пути "C:\Documents and Settings\&lt;user
        name&gt;\WINDOWS". Какой из них может быть получен, зависит от имени
        исполняемого файла и способа его запуска. Если файл программы называется
        setup.exe или install.exe, или же запускается из апплета панели
        управления "<i>Удаление или изменение программы</i>", Windows переключит
        систему в "режим установки", в результате чего программа будет вести
        себя так, как если бы был установлен флаг "Terminal Services aware".
        Иначе программа рассматривается как устаревшее приложение и получает
        частный каталог Windows (даже если пользователь, запускающий программу,
        имеет права администратора).</p>
      <p>Поскольку поведение, возникающее в результате установки
        для <tt>TerminalServicesAware</tt> значения <tt>no</tt>, является
        противоречивым и трудно прогнозируемым, рекомендуется всегда
        использовать значение по умолчанию <tt>yes</tt>. Значение <tt>no</tt>
        допускается применять только в качестве временной меры для поиска и
        исправления проблем в системах со службами терминалов после очередного
        обновления Inno Setup.</p>
    </div>
  </body>
</html>
