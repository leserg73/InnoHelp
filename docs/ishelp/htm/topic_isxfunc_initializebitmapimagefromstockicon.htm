<!DOCTYPE html>
<html lang="ru" data-theme="light">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="Content-Language" content="ru" />
    <meta http-equiv="X-UA-Compatible" content="IE=11" />
    <meta content="Перевод на русский: Сергей Леонов (aka Leserg)" name="description" />
    <title>Программирование: InitializeBitmapImageFromStockIcon</title>
    <link rel="stylesheet" type="text/css" href="../css/styles.css" />
    <link rel="stylesheet" type="text/css" href="../css/shared.css" />
    <script type="text/javascript" src="../js/topic.js"></script>
    <script type="text/javascript" src="../js/jquery.js"></script>
    <script type="text/javascript" src="../js/highlight.js"></script>
    <script type="text/javascript">
      $(document).ready(function(){highlight();});
    </script>
  </head>
  <body>
    <h1 class="topicheading">Программирование: InitializeBitmapImageFromStockIcon</h1>
    <div class="topicbody">
      <h2 class="heading prototip">Прототип</h2>
      <p class="prototip1 notopmarginX">function
        InitializeBitmapImageFromStockIcon(const BitmapImage: TBitmapImage;
        const Siid: Integer; const BkColor: TColor; const AscendingTrySizes:
        TArrayOfInteger): Boolean;</p>
      <h2 class="heading">Описание</h2>
      <p>Выполняет инициализацию растрового изображения стандартного системного
        значка с указанным идентификтором <tt>Siid</tt>, используя заданный цвет
        фона <tt>BkColor</tt> для прозрачных частей изображения.</p>
      <p>Растровое изображение <tt>BitmapImage</tt> уже должно быть
        масштабировано и тогда функция загрузит наиболее подходящий под
        указанные в массиве размеры значок. После загрузки функция установит
        размеры растрового изображения согласно размерам значка.</p>
      <p>Все значения в массиве <tt>AscendingTrySizes</tt> должны быть
        отсортированы от наименьшего размера к наибольшему.</p>
      <p>Если в массиве не будет найдено соответствующее совпадение (например,
        потому что он пустой), в качестве размера будет использоваться минимальная
        ширина и высота растрового изображения.</p>
      <p>В отличие от <a href="topic_isxfunc_initializebitmapimagefromicon.htm">InitializeBitmapImageFromIcon</a>,
        эта функция поддерживает произвольные размеры.</p>
      <p>Функция возвращает значение <tt>True</tt>, если значок может быть
        успешно загружен, в противном случае — <tt>False</tt>.</p>
      <h2 class="heading">Комментарии</h2>
      <p>Смотрите перечень всех доступных значков на портале <a 
        href="https://learn.microsoft.com/en-us/windows/win32/api/shellapi/ne-shellapi-shstockiconid#constants"
        target="_blank" title="https://learn.microsoft.com/en-us/windows/win32/api/shellapi/ne-shellapi-shstockiconid#constants">Microsoft
        Learn</a><img class="extlink" src="../images/extlink.svg" alt=" [внешняя ссылка]" />.</p>
      <p><tt>Siid</tt> поддерживает следующие значения:</p>
      <p class="indent" style="text-align: left"><code>SIID_DOCNOASSOC, SIID_DOCASSOC,
        SIID_APPLICATION, SIID_FOLDER, SIID_FOLDEROPEN,
        SIID_DRIVE525, SIID_DRIVE35, SIID_DRIVEREMOVE, SIID_DRIVEFIXED, SIID_DRIVENET,
        SIID_DRIVENETDISABLED, SIID_DRIVECD, SIID_DRIVERAM, SIID_WORLD, SIID_SERVER,
        SIID_PRINTER, SIID_MYNETWORK, SIID_FIND, SIID_HELP, SIID_SHARE, SIID_LINK,
        SIID_SLOWFILE, SIID_RECYCLER, SIID_RECYCLERFULL, SIID_MEDIACDAUDIO, SIID_LOCK,
        SIID_AUTOLIST, SIID_PRINTERNET, SIID_SERVERSHARE, SIID_PRINTERFAX,
        SIID_PRINTERFAXNET, SIID_PRINTERFILE, SIID_STACK, SIID_MEDIASVCD,
        SIID_STUFFEDFOLDER, SIID_DRIVEUNKNOWN, SIID_DRIVEDVD, SIID_MEDIADVD,
        SIID_MEDIADVDRAM, SIID_MEDIADVDRW, SIID_MEDIADVDR, SIID_MEDIADVDROM,
        SIID_MEDIACDAUDIOPLUS, SIID_MEDIACDRW, SIID_MEDIACDR, SIID_MEDIACDBURN,
        SIID_MEDIABLANKCD, SIID_MEDIACDROM, SIID_AUDIOFILES, SIID_IMAGEFILES,
        SIID_VIDEOFILES, SIID_MIXEDFILES, SIID_FOLDERBACK, SIID_FOLDERFRONT, SIID_SHIELD,
        SIID_WARNING, SIID_INFO, SIID_ERROR, SIID_KEY, SIID_SOFTWARE, SIID_RENAME,
        SIID_DELETE, SIID_MEDIAAUDIODVD, SIID_MEDIAMOVIEDVD, SIID_MEDIAENHANCEDCD,
        SIID_MEDIAENHANCEDDVD, SIID_MEDIAHDDVD, SIID_MEDIABLURAY, SIID_MEDIAVCD,
        SIID_MEDIADVDPLUSR, SIID_MEDIADVDPLUSRW, SIID_DESKTOPPC, SIID_MOBILEPC,
        SIID_USERS, SIID_MEDIASMARTMEDIA, SIID_MEDIACOMPACTFLASH, SIID_DEVICECELLPHONE,
        SIID_DEVICECAMERA, SIID_DEVICEVIDEOCAMERA, SIID_DEVICEAUDIOPLAYER,
        SIID_NETWORKCONNECT, SIID_INTERNET, SIID_ZIPFILE, SIID_SETTINGS, SIID_DRIVEHDDVD,
        SIID_DRIVEBD, SIID_MEDIAHDDVDROM, SIID_MEDIAHDDVDR, SIID_MEDIAHDDVDRAM,
        SIID_MEDIABDROM, SIID_MEDIABDR, SIID_MEDIABDRE, SIID_CLUSTEREDDRIVE</code></p>
      <h2 class="heading">Пример</h2>
      <pre class="indent examplebox"><span class="hl kwb">procedure</span> <span

class="hl kwd">InitializeWizard</span>;
<span class="hl kwb">var</span>
  Page: TWizardPage;
  BitmapImage: TBitmapImage;
<span class="hl kwb">begin</span>
  Page := CreateCustomPage(<span class="hl kwe">wpWelcome</span>, <span class="hl str">'Test'</span>, <span

class="hl str">'Test'</span>);

  BitmapImage := TBitmapImage.Create(Page);
  
  <span class="hl kwb">with</span> BitmapImage <span class="hl kwb">do begin</span>
    Width := ScaleX(<span class="hl num">32</span>);
    Height := ScaleY(<span class="hl num">32</span>);
    Parent := Page.Surface;
  <span class="hl kwb">end</span>;

  InitializeBitmapImageFromStockIcon(BitmapImage, <span class="hl kwc">SIID_ERROR</span>, clNone, [<span

class="hl num">32</span>, <span class="hl num">48</span>, <span class="hl num">64</span>]);   
<span class="hl kwb">end</span>;
</pre>
      <h2 class="heading">См. также:</h2>
      <p class="indent"><a href="topic_isxfunc_initializebitmapimagefromicon.htm">InitializeBitmapImageFromIcon</a>
      </p>
    </div>
  <script type="text/javascript" src="../js/theme_selector.js"></script>
  </body>
</html>
