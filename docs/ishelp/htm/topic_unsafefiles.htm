<!DOCTYPE html>
<html lang="ru" data-theme="light">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="Content-Language" content="ru" />
    <meta http-equiv="X-UA-Compatible" content="IE=11" />
    <meta content="Перевод на русский: Сергей Леонов (aka Leserg)" name="description" />
    <title>Небезопасные файлы</title>
    <link rel="stylesheet" type="text/css" href="../css/styles.css" />
    <link rel="stylesheet" type="text/css" href="../css/shared.css" />
    <script type="text/javascript" src="../js/topic.js"></script>
    <script type="text/javascript" src="../js/jquery.js"></script>
    <script type="text/javascript" src="../js/highlight.js"></script>
    <script type="text/javascript">
      $(document).ready(function(){highlight();});
    </script>
  </head>
  <body>
    <h1 class="topicheading">Небезопасные файлы</h1>
    <div class="topicbody">
      <p>Для удобства новых пользователей, которые не знают,
        какие файлы можно, а какие нельзя включать в пакет поставки программы,
        компилятор выдаст сообщение об ошибке при попытке установки так
        называемых "небезопасных" файлов, используя секцию <a href="topic_filessection.htm">[Files]</a>.
        Эти файлы перечислены ниже.</p>
      <p>(Примечание: сообщение об ошибке можно отключить,
        используя определённый флаг в секции <tt>[Files]</tt>, но делать этого
        крайне НЕ рекомендуется.)</p>
      <dl>
        <dt><b>Любой файл DLL из системного каталога Windows</b></dt>
        <dd>
          <p>Не следует развёртывать какие-либо DLL файлы из собственного
            системного каталога Windows в каталог <tt>{sys}</tt> пользователя,
            поскольку многие из них соответствуют строго определённой версии
            Windows и не будут работать при установке на другую версию. В
            большинстве случаев установка DLL из другой версии Windows приведёт
            к тому, что система пользователя <b>перестанет загружаться</b>.
            Другая причина, почему не следует пользоваться такой практикой
            заключается в том, что при установке программ на ваш компьютер,
            файлы DLL могут быть заменены другими, несовместимыми версиями, без
            вашего ведома. Это может привести к непредсказуемым и трудно
            решаемым проблемам на системах пользователей при создании новых
            установок.</p>
          <p>Вместо развертывания библиотек DLL из системного каталога Windows
            вы должны найти версии, которые специально предназначены для
            "распространения". Свободно распространяемые библиотеки DLL обычно
            поддерживают несколько версий Windows. Чтобы найти такие версии
            динамических библиотек Visual Basic и Visual C ++, см. раздел
            справки "Часто задаваемые вопросы по Inno Setup".</p>
          <p>Если вы <b>абсолютно уверены</b>, что имеющаяся у вас библиотека
            DLL, находящаяся в системном каталоге Windows, является свободно
            распространяемой, скопируйте её в исходную папку с вашим сценарием и
            используйте только оттуда.</p>
        </dd>
        <dt><b>ADVAPI32.DLL, COMDLG32.DLL, GDI32.DLL, KERNEL32.DLL,
            RICHED32.DLL, SHELL32.DLL, USER32.DLL, UXTHEME.DLL</b></dt>
        <dd>
          <p>Все эти файлы являются основными компонентами Windows и никогда не
            должны развёртываться при помощи программы установки. Пользователи
            могут получать новые версии этих библиотек только при установке
            новой версии Windows, пакета обновления или исправления для Windows.</p>
        </dd>
        <dt><b>COMCAT.DLL, MSVBVM50.DLL,
            MSVBVM60.DLL, OLEAUT32.DLL, OLEPRO32.DLL, STDOLE2.TLB</b>
            <i>(в особых случаях)</i></dt>
        <dd>
          <p>Если значение <tt>DestDir</tt> <i>отличается</i> от <tt>{sys}</tt>
            и используется флаг <tt>regserver</tt> или <tt>regtypelib</tt>, то
            указанные библиотеки будут считаться "небезопасными". Эти файлы
            никогда не должны устанавливаться и регистрироваться в другом
            каталоге, кроме как <tt>{sys}</tt>, поскольку <i>все</i> программы
            в системе начнут использовать их по умолчанию вместо файлов в <tt>{sys}</tt>.
            Также могут возникнуть проблемы, если ваши версии файлов окажутся
            старше, чем имеющиеся версии файлов в каталоге <tt>{sys}</tt>.
            Кроме того, если ваши копии файлов были удалены, то другие
            приложения перестанут работать.</p>
        </dd>
        <dt><b>COMCTL32.DLL</b></dt>
        <dd>
          <p>Microsoft не разрешает отдельное перераспределение COMCTL32.DLL (и
            это правильно - файл между платформами отличается), поэтому никогда
            не следует помещать COMCTL32.DLL в секцию <tt>[Files]</tt>. Однако
            можно направить пользователей <a
            href="http://www.microsoft.com/downloads/details.aspx?FamilyID=cb2cf3a2-8025-4e8f-8511-9b476a8d35d2&amp;DisplayLang=en"
            target="_blank" title="http://www.microsoft.com/downloads/details.aspx?FamilyID=cb2cf3a2-8025-4e8f-8511-9b476a8d35d2&amp;DisplayLang=en">на
            загрузку обновления COMCTL32 с сайта Microsoft</a><img src="../images/extlink.svg"
            alt=" [внешняя ссылка]" /> или добавить обновление COMCTL32 к вашей
            программе.</p>
        </dd>
        <dt><b>SHDOCVW.DLL, SHLWAPI.DLL, URLMON.DLL, WININET.DLL</b></dt>
        <dd>
          <p>Эти файлы являются компонентами ядра Internet Explorer, а также
            используются проводником Windows. Их замена может помешать запуску
            проводника. Если ваше приложение зависит от этих DLL файлов или от
            их последней версии, то вашим пользователям нужно будет установить
            последнюю версию Internet Explorer, чтобы получить их.</p>
        </dd>
        <dt><b>MSCOREE.DLL</b></dt>
        <dd>
          <p>Этот файл является частью Microsoft .NET Framework. Невозможно
            безопасно установить или обновить .NET Framework, включив этот файл
            в пакет установки. Вместо этого вызовите dotnetfx.exe или направьте
            пользователей на его использование.</p>
        </dd>
      </dl>
    </div>
  <script type="text/javascript" src="../js/theme_selector.js"></script>
  </body>
</html>
