<!DOCTYPE html>
<html lang="ru" data-theme="light">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="Content-Language" content="ru" />
    <meta http-equiv="X-UA-Compatible" content="IE=11" />
    <meta content="Перевод на русский: Сергей Леонов (aka Leserg)" name="description" />
    <title>Программирование: CreateExtractionPage</title>
    <link rel="stylesheet" type="text/css" href="../css/styles.css" />
    <link rel="stylesheet" type="text/css" href="../css/shared.css" />
    <script type="text/javascript" src="../js/topic.js"></script>
    <script type="text/javascript" src="../js/jquery.js"></script>
    <script type="text/javascript" src="../js/highlight.js"></script>
    <script type="text/javascript">
      $(document).ready(function(){highlight();});
    </script>
  </head>
  <body>
    <h1 class="topicheading">Программирование: CreateExtractionPage</h1>
    <div class="topicbody">
      <h2 class="heading prototip">Прототип</h2>
        <p class="prototip1 notopmarginX">function
          CreateExtractionPage(const ACaption, ADescription: String; const
          OnExtractionProgress: TOnExtractionProgress): TExtractionWizardPage;</p>
      <h2 class="heading">Описание</h2>
        <p>Выполняет создание страницы для мастера установки для извлечения архивов
          и отображения прогресса выполнения.</p>
        <p>Поддерживаемые форматы архивов, помимо .7z, а также поддержка защищённых
          паролем и многотомных архивов, зависят от значения директивы <a
          href="topic_setup_archiveextraction.htm">ArchiveExtraction</a> в секции
          <tt>[Setup]</tt>.</p>
        <p>Чтобы разрешить извлечение архивов с пользовательскими расширениями,
          например самораспаковывающихся архивов, используйте вызов <a
          href="topic_isxfunc_maparchiveextensions.htm">MapArchiveExtensions</a>.</p>
        <p>Для параметра <tt>OnExtractionProgress</tt> укажите функцию, которая
          будет передавать информацию о ходе загрузки, или значение <tt>nil</tt>,
          если в этом нет необходимости.</p>
        <p>В отличии от других типов страниц мастера установки, страницы с ходом
          выполнения не отображаются как часть обычной последовательности страниц
          (обратите внимание на отсутствие параметра <tt>AfterID</tt>). Страница
          с ходом выполнения распаковки может быть показана только программно,
          путём вызова метода <tt>Show</tt>.</p>
      <h2 class="heading">Комментарии</h2>
        <p>Для активации страницы используйте вызов метода <tt>Show</tt>. По
          окончании процесса распаковки используйте вызов <tt>Hide</tt>, чтобы
          вернуться на предыдущую страницу.</p>
        <p>Вызов метода <tt>Hide</tt> всегда размещайте внутри блока <tt>finally</tt>
          конструкции <tt>try..finally</tt>, как это показано в примере
          <i>CodeDownloadFiles.iss</i>. Если не вызвать <tt>Hide</tt>, то
          мастер установки навсегда застрянет на странице с ходом выполнения.</p>
        <p>Чтобы распаковать новый архив, используйте вызов метода <tt>Add</tt>
          или метод <tt>AddEx</tt>, если архив защищён паролем. Перед добавлением
          первого архива всегда вызывайте метод <tt>Clear</tt>.</p>
        <p>Для запуска распаковки вызовите метод <tt>Extract</tt>. В случае
          возникновения ошибки будет вызвано исключение. Иначе <tt>Extract</tt>
          вернёт количество распакованных архивов.</p>
        <p>Установите для свойства <tt>ShowArchiveInsteadFile</tt> значение
          <tt>True</tt>, чтобы показать пользователю имя распаковываемого архива
          вместо имён файлов, которые находятся внутри архива.</p>
        <p>Объявление класса <tt>TOnExtractionProgress</tt> смотрите в разделе
          <a href="topic_isxfunc_extractarchive.htm">ExtractArchive</a>
          настоящей справки.</p>
      <h2 class="heading">Пример</h2>
        <p>Смотрите сценарий <i>CodeDownloadFiles.iss</i> с функцией
          <tt>CreateDownloadPage</tt>, которая подобна <tt>CreateExtractionPage</tt>,
          и примером распаковки архива с использованием записи в секции
          <tt>[Files]</tt>.</p>
      <p>Также смотрите пример сценария <i>DownloadFiles.iss</i>, который показывает
        возможность загрузки файла при помощи записи в секции <tt>[Files]</tt>.</p>
    <h2 class="heading">См. также:</h2>
      <p class="indent"><a href="topic_scriptclasses.htm#TExtractionWizardPage">TExtractionWizardPage</a><br />
        <a href="topic_isxfunc_extractarchive.htm">ExtractArchive</a><br />
        <a href="topic_isxfunc_maparchiveextensions.htm">MapArchiveExtensions</a><br />
        <a href="topic_isxfunc_createoutputprogresspage.htm">CreateOutputProgressPage</a>
      </p>
    </div>
  <script type="text/javascript" src="../js/theme_selector.js"></script>
  </body>
</html>
